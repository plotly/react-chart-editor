{"version":3,"sources":["../../src/lib/connectCartesianSubplotToLayout.js"],"names":["connectCartesianSubplotToLayout","WrappedComponent","SubplotConnectedComponent","props","context","updateSubplot","bind","setLocals","nextProps","nextContext","xaxis","yaxis","traceIndexes","container","fullContainer","data","trace","length","fullTrace","icon","name","getValObject","attr","replace","updateContainer","deleteContainer","deleteSubplot","update","newUpdate","key","newKey","Component","displayName","propTypes","PropTypes","string","isRequired","contextTypes","object","array","fullData","onUpdate","func","childContextTypes","plotly_editor_traits"],"mappings":";;;;;;;;;;kBAIwBA,+B;;AAJxB;;;;AACA;;;;AACA;;;;;;;;;;AAEe,SAASA,+BAAT,CAAyCC,gBAAzC,EAA2D;AAAA,MAClEC,yBADkE;AAAA;;AAEtE,uCAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA,wJACpBD,KADoB,EACbC,OADa;;AAG1B,YAAKC,aAAL,GAAqB,MAAKA,aAAL,CAAmBC,IAAnB,OAArB;AACA,YAAKC,SAAL,CAAeJ,KAAf,EAAsBC,OAAtB;AAJ0B;AAK3B;;AAPqE;AAAA;AAAA,gDAS5CI,SAT4C,EASjCC,WATiC,EASpB;AAChD,aAAKF,SAAL,CAAeC,SAAf,EAA0BC,WAA1B;AACD;AAXqE;AAAA;AAAA,gCAa5DN,KAb4D,EAarDC,OAbqD,EAa5C;AAAA,YACjBM,KADiB,GACaP,KADb,CACjBO,KADiB;AAAA,YACVC,KADU,GACaR,KADb,CACVQ,KADU;AAAA,YACHC,YADG,GACaT,KADb,CACHS,YADG;AAAA,YAEjBC,SAFiB,GAEiBT,OAFjB,CAEjBS,SAFiB;AAAA,YAENC,aAFM,GAEiBV,OAFjB,CAENU,aAFM;AAAA,YAESC,IAFT,GAEiBX,OAFjB,CAESW,IAFT;;;AAIxB,aAAKF,SAAL,GAAiB;AACfH,iBAAOG,UAAUH,KAAV,CADQ;AAEfC,iBAAOE,UAAUF,KAAV;AAFQ,SAAjB;AAIA,aAAKG,aAAL,GAAqB;AACnBJ,iBAAOI,cAAcJ,KAAd,CADY;AAEnBC,iBAAOG,cAAcH,KAAd;AAFY,SAArB;;AAKA,YAAMK,QAAQJ,aAAaK,MAAb,GAAsB,CAAtB,GAA0BF,KAAKH,aAAa,CAAb,CAAL,CAA1B,GAAkD,EAAhE;AACA,YAAMM,YAAY,uBAAaf,KAAb,EAAoBC,OAApB,CAAlB;;AAEA,YAAIY,SAASE,SAAb,EAAwB;AACtB,eAAKC,IAAL,GAAY,0BAAgB,mCAAyBH,KAAzB,CAAhB,CAAZ;AACA,eAAKI,IAAL,GAAYF,UAAUE,IAAtB;AACD;AACF;AAjCqE;AAAA;AAAA,wCAmCpD;AAAA;;AAChB,eAAO;AACLC,wBAAc;AAAA,mBACZ,CAAC,OAAKjB,OAAL,CAAaiB,YAAd,GACI,IADJ,GAEI,OAAKjB,OAAL,CAAaiB,YAAb,CACEC,KAAKC,OAAL,CAAa,OAAb,EAAsB,OAAKpB,KAAL,CAAWO,KAAjC,EAAwCa,OAAxC,CAAgD,OAAhD,EAAyD,OAAKpB,KAAL,CAAWQ,KAApE,CADF,CAHQ;AAAA,WADT;AAOLa,2BAAiB,KAAKnB,aAPjB;AAQLoB,2BAAiB,KAAKC,aARjB;AASLb,qBAAW,KAAKA,SATX;AAULC,yBAAe,KAAKA;AAVf,SAAP;AAYD;AAhDqE;AAAA;AAAA,qCAkDvD;AAAA;;AACb,eAAO;AACLO,wBAAc;AAAA,mBACZ,CAAC,OAAKjB,OAAL,CAAaiB,YAAd,GACI,IADJ,GAEI,OAAKjB,OAAL,CAAaiB,YAAb,CACEC,KAAKC,OAAL,CAAa,OAAb,EAAsB,OAAKpB,KAAL,CAAWO,KAAjC,EAAwCa,OAAxC,CAAgD,OAAhD,EAAyD,OAAKpB,KAAL,CAAWQ,KAApE,CADF,CAHQ;AAAA,WADT;AAOLa,2BAAiB,KAAKnB,aAPjB;AAQLoB,2BAAiB,KAAKC,aARjB;AASLb,qBAAW,KAAKA,SATX;AAULC,yBAAe,KAAKA;AAVf,SAAP;AAYD;AA/DqE;AAAA;AAAA,oCAiExDa,MAjEwD,EAiEhD;AACpB,YAAMC,YAAY,EAAlB;AACA,aAAK,IAAMC,GAAX,IAAkBF,MAAlB,EAA0B;AACxB,cAAMG,SAASD,IAAIN,OAAJ,CAAY,OAAZ,EAAqB,KAAKpB,KAAL,CAAWO,KAAhC,EAAuCa,OAAvC,CAA+C,OAA/C,EAAwD,KAAKpB,KAAL,CAAWQ,KAAnE,CAAf;AACAiB,oBAAUE,MAAV,IAAoBH,OAAOE,GAAP,CAApB;AACD;AACD,aAAKzB,OAAL,CAAaoB,eAAb,CAA6BI,SAA7B;AACD;AAxEqE;AAAA;AAAA,+BA0E7D;AACP,eAAO,8BAAC,gBAAD,aAAkB,MAAM,KAAKR,IAA7B,EAAmC,MAAM,KAAKD,IAA9C,IAAwD,KAAKhB,KAA7D,EAAP;AACD;AA5EqE;;AAAA;AAAA,IAChC4B,gBADgC;;AA+ExE7B,4BAA0B8B,WAA1B,wBAA2D,yBAAe/B,gBAAf,CAA3D;;AAEAC,4BAA0B+B,SAA1B,GAAsC;AACpCvB,WAAOwB,oBAAUC,MAAV,CAAiBC,UADY;AAEpCzB,WAAOuB,oBAAUC,MAAV,CAAiBC;AAFY,GAAtC;;AAKAlC,4BAA0BmC,YAA1B,GAAyC;AACvCxB,eAAWqB,oBAAUI,MADkB;AAEvCxB,mBAAeoB,oBAAUI,MAFc;AAGvCvB,UAAMmB,oBAAUK,KAHuB;AAIvCC,cAAUN,oBAAUK,KAJmB;AAKvCE,cAAUP,oBAAUQ,IALmB;AAMvClB,qBAAiBU,oBAAUQ,IANY;AAOvCrB,kBAAca,oBAAUQ;AAPe,GAAzC;;AAUAxC,4BAA0ByC,iBAA1B,GAA8C;AAC5CnB,qBAAiBU,oBAAUQ,IADiB;AAE5CjB,qBAAiBS,oBAAUQ,IAFiB;AAG5C7B,eAAWqB,oBAAUI,MAHuB;AAI5CxB,mBAAeoB,oBAAUI,MAJmB;AAK5CjB,kBAAca,oBAAUQ;AALoB,GAA9C;;AAhGwE,MAwGjEE,oBAxGiE,GAwGzC3C,gBAxGyC,CAwGjE2C,oBAxGiE;;AAyGxE1C,4BAA0B0C,oBAA1B,GAAiDA,oBAAjD;;AAEA,SAAO1C,yBAAP;AACD","file":"connectCartesianSubplotToLayout.js","sourcesContent":["import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport {getDisplayName, plotlyTraceToCustomTrace, renderTraceIcon, getFullTrace} from '../lib';\n\nexport default function connectCartesianSubplotToLayout(WrappedComponent) {\n  class SubplotConnectedComponent extends Component {\n    constructor(props, context) {\n      super(props, context);\n\n      this.updateSubplot = this.updateSubplot.bind(this);\n      this.setLocals(props, context);\n    }\n\n    componentWillReceiveProps(nextProps, nextContext) {\n      this.setLocals(nextProps, nextContext);\n    }\n\n    setLocals(props, context) {\n      const {xaxis, yaxis, traceIndexes} = props;\n      const {container, fullContainer, data} = context;\n\n      this.container = {\n        xaxis: container[xaxis],\n        yaxis: container[yaxis],\n      };\n      this.fullContainer = {\n        xaxis: fullContainer[xaxis],\n        yaxis: fullContainer[yaxis],\n      };\n\n      const trace = traceIndexes.length > 0 ? data[traceIndexes[0]] : {};\n      const fullTrace = getFullTrace(props, context);\n\n      if (trace && fullTrace) {\n        this.icon = renderTraceIcon(plotlyTraceToCustomTrace(trace));\n        this.name = fullTrace.name;\n      }\n    }\n\n    getChildContext() {\n      return {\n        getValObject: attr =>\n          !this.context.getValObject\n            ? null\n            : this.context.getValObject(\n                attr.replace('xaxis', this.props.xaxis).replace('yaxis', this.props.yaxis)\n              ),\n        updateContainer: this.updateSubplot,\n        deleteContainer: this.deleteSubplot,\n        container: this.container,\n        fullContainer: this.fullContainer,\n      };\n    }\n\n    provideValue() {\n      return {\n        getValObject: attr =>\n          !this.context.getValObject\n            ? null\n            : this.context.getValObject(\n                attr.replace('xaxis', this.props.xaxis).replace('yaxis', this.props.yaxis)\n              ),\n        updateContainer: this.updateSubplot,\n        deleteContainer: this.deleteSubplot,\n        container: this.container,\n        fullContainer: this.fullContainer,\n      };\n    }\n\n    updateSubplot(update) {\n      const newUpdate = {};\n      for (const key in update) {\n        const newKey = key.replace('xaxis', this.props.xaxis).replace('yaxis', this.props.yaxis);\n        newUpdate[newKey] = update[key];\n      }\n      this.context.updateContainer(newUpdate);\n    }\n\n    render() {\n      return <WrappedComponent name={this.name} icon={this.icon} {...this.props} />;\n    }\n  }\n\n  SubplotConnectedComponent.displayName = `SubplotConnected${getDisplayName(WrappedComponent)}`;\n\n  SubplotConnectedComponent.propTypes = {\n    xaxis: PropTypes.string.isRequired,\n    yaxis: PropTypes.string.isRequired,\n  };\n\n  SubplotConnectedComponent.contextTypes = {\n    container: PropTypes.object,\n    fullContainer: PropTypes.object,\n    data: PropTypes.array,\n    fullData: PropTypes.array,\n    onUpdate: PropTypes.func,\n    updateContainer: PropTypes.func,\n    getValObject: PropTypes.func,\n  };\n\n  SubplotConnectedComponent.childContextTypes = {\n    updateContainer: PropTypes.func,\n    deleteContainer: PropTypes.func,\n    container: PropTypes.object,\n    fullContainer: PropTypes.object,\n    getValObject: PropTypes.func,\n  };\n\n  const {plotly_editor_traits} = WrappedComponent;\n  SubplotConnectedComponent.plotly_editor_traits = plotly_editor_traits;\n\n  return SubplotConnectedComponent;\n}\n"]}